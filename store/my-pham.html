<!-- REPLACE WHOLE FILE: /store/my-pham.html -->
<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>

<title>Mỹ phẩm | NThương Store</title>
<meta name="description" content="Danh mục Mỹ phẩm — hiển thị sản phẩm từ affiliates.json theo chuẩn MXD."/>
<link rel="canonical" href="https://nthuong09.github.io/store/my-pham.html"/>
<meta name="robots" content="index,follow"/>

<meta property="og:title" content="Mỹ phẩm | NThương Store"/>
<meta property="og:description" content="Danh mục Mỹ phẩm"/>
<meta property="og:url" content="https://nthuong09.github.io/store/my-pham.html"/>
<meta property="og:image" content="https://nthuong09.github.io/assets/og/default-og.webp"/>

<!-- THEME: Pink (Hường) cho hub Mỹ phẩm -->
<style>
  :root{
    --brand:#c2185b; --accent:#ff2d8d; --border:#ffd1e8;
    --text:#251a24; --muted:#6b5f67; --bg:#fff;
  }
  body{background:var(--bg); color:var(--text);}
  .topbar{background:#fff5fa;border-bottom:1px solid var(--border)}
  .topbar .nav{display:flex;justify-content:space-between;align-items:center;gap:1rem;padding:10px 0}
  .brand{font-weight:800;color:var(--brand);text-decoration:none}
  .topbar nav a{margin:0 10px;color:#7c3b57;text-decoration:none}
  .topbar nav a:hover{color:var(--brand)}
  .container{max-width:1080px;margin:0 auto;padding:0 16px}
  h1{margin:16px 0 8px}
  .muted{color:var(--muted)}
  .product-grid{display:grid;grid-template-columns:repeat(4,minmax(220px,1fr));gap:16px}
  @media (max-width:1100px){ .product-grid{grid-template-columns:repeat(3,1fr);} }
  @media (max-width:720px){ .product-grid{grid-template-columns:repeat(2,1fr);} }
  .product-card{border:1px solid var(--border);border-radius:16px;overflow:hidden;background:#fff}
  .product-card img{width:100%;height:200px;object-fit:cover}
  .product-card .badge{display:inline-block;background:#ffe3f0;color:#a31754;border-radius:999px;padding:.15rem .55rem;margin:.25rem .75rem}
  .btn{display:inline-block;padding:.6rem 1rem;border-radius:999px;text-decoration:none;border:1px solid transparent}
  .btn.buy{background:var(--accent);color:#fff;box-shadow:0 6px 20px rgba(255,45,141,.25)}
  footer{background:#fff5fa;margin-top:28px}
</style>

<link rel="stylesheet" href="/assets/site.css"/>
<!-- GA4 trước affiliate -->
<script defer src="/assets/analytics.js"></script>
<script defer src="/assets/mxd-affiliate.js"></script>
</head>
<body>
<header class="topbar"><div class="container nav">
  <a class="brand" href="/">NThương Store</a>
  <nav>
    <a href="/">Trang chủ</a>
    <a href="/store.html">Cửa hàng</a>
    <a href="/store/thoi-trang.html">Thời trang</a>
    <a href="/store/my-pham.html">Mỹ phẩm</a>
    <a href="/store/me-va-be.html">Mẹ & Bé</a>
    <a href="/store/trang-suc.html">Trang sức</a>
    <a href="/lien-he.html">Liên hệ</a>
  </nav>
</div></header>

<header class="container"><h1>Mỹ phẩm</h1></header>
<main class="container">
  <div id="grid" class="product-grid"><p>Đang tải…</p></div>
</main>
<footer><div class="container"><small class="muted">© 2025 — NThương Store • MXD Canonical</small></div></footer>

<script>
/* FIND: category hub loader v2025-10-31-b02 — slug=my-pham (await r.json()) */
const SLUG = 'my-pham';
const $ = (id)=>document.getElementById(id);

function priceText(v){ const n=Number(v); return Number.isFinite(n)? n.toLocaleString('vi-VN')+' ₫' : ''; }
function imgPath(p){ return p.image || ('/assets/img/products/'+p.sku+'.webp'); }
function card(p){
  const origin = p.origin_url ?? p.origin ?? '#';
  const priceRaw = p.price_vnd ?? p.price;
  const price = priceText(priceRaw);
  return `
    <div class="card product-card">
      <a class="product-meta" href="${origin}"
         data-merchant="${p.merchant||''}" data-sku="${p.sku}"
         data-img="${imgPath(p)}" ${Number.isFinite(Number(priceRaw))?`data-price="${Number(priceRaw)}"`:''}>${p.name}</a>
      <img src="${imgPath(p)}" alt="${p.name}"/>
      ${price?`<p style="margin:.5rem .75rem"><strong>${price}</strong></p>`:''}
      <p><span class="badge">${p.merchant||''}</span></p>
      <p style="margin:.5rem .75rem 1rem"><a class="btn buy" href="#">Mua ngay</a></p>
    </div>`;
}

async function loadAffiliates(){
  const candidates=['/assets/data/affiliates.json','/affiliates.json'];
  for(const url of candidates){
    try{
      const r=await fetch(url,{cache:'no-store'});
      if(r.ok){
        const j = await r.json(); // keep: await r.json()
        if(Array.isArray(j)) return j;
      }
    }catch(e){}
  }
  return [];
}

(async()=>{
  try{
    const list = await loadAffiliates();
    const items = list
      .filter(p => ((p.category||'').toLowerCase().startsWith(SLUG)) && (p.status !== false))
      .slice(0,60);
    $('grid').innerHTML = items.length ? items.map(card).join('') : '<p>Chưa có sản phẩm trong danh mục này.</p>';

    // JSON-LD ItemList
    const itemList = {"@context":"https://schema.org","@type":"ItemList","itemListElement":items.map((p,i)=>({"@type":"ListItem","position":i+1,"url":new URL('/g.html?sku='+encodeURIComponent(p.sku),location.origin).href}))};
    const s=document.createElement('script'); s.type='application/ld+json'; s.textContent=JSON.stringify(itemList); document.head.appendChild(s);
  }catch(e){
    $('grid').innerHTML = '<p>Lỗi tải dữ liệu.</p>';
    console.error(e);
  }

  // MXD-CHECK: SW register
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js').catch(()=>{});
  }
})();
</script>
</body>
</html>
